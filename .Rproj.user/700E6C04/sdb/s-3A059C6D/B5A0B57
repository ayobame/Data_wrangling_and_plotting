{
    "contents" : "<style>\n.small-code pre code {\n  font-size: 0.75em;\n}\n</style>\n\nggplot2\n========================================================\nauthor: Etienne Low-Décarie\ndate: September 12, 2015\n\nWaiting around?\n===\nclass: small-code\n\nLet R impress you:\n```{r eval=FALSE}\ndemo(package = .packages(all.available = TRUE))\n```\n- you will get a text file with all available demos\n- choose one of interest \n- if needed load its package\n\n***\n\n- type it in the demo brackets\n- example\n```{r eval=FALSE}\nlibrary(googleVis)\ndemo(smooth)\n```\n- notice it shows you the code that creates the demo!\n- look at packages on http://crantastic.org\n\n\nTell me about you\n===\n\n- Have you created a plot?\n- With what data?\n- What kind of plot?\n- Have plotted with R?\n- used ggplot?\n- How many variables do you usually need to put into a plot?\n- Do you need to produce maps?\n- Have you used stackoverflow?\n- Are you in buddy pairs?\n- Who uses Rstudio as their IDE?\n\nOutline\n===\n\n- 09:00-11:00 ggplot2\n- 11:00-13:30 lunch (potential to work on challenge)\n- 13:30-14:00 tidyr\n- 14:00-15:30 dplyr\n- 15:30-16:30 Maps using ggplot/ggmap\n- 16:30-17:30 Coding dojo\n\nHow we will work\n===\n\n![How we will work](./ggplot2_images/how we work.png)\n\n\n\nA few pet peeves\n===\n\n- Always work from a script\n- Use carriage returns and indentation\n\n```{r eval=F}\nobject <- function(argument1=\"value1\",\n                   argument2=\"value2\",\n                   argument3=\"value3\")\n```\n\n- Create your own new script\n  + refer to provided code only if needed\n  + don't use the one provided\n\n```{r fig.width=7, fig.height=6,echo=FALSE}\nlibrary(png)\nlibrary(grid)\n```\n\n\nA few preferences\n===\n\n- Use RStudio\n  - Use RStudio projects (or R package etc.)\n- Craete organized folder structure\n  - Data\n  - Plots\n  - Scripts\n  - Output\n  - etc\n\n\nWithout R\n===\n\n![Without R](./ggplot2_images/without_r.png)\n\nWith R \n===\n\n![With R](./ggplot2_images/with_r.png)\n\n\n\nBeautiful and flexible! \n===\n\n![Pretty ggplots](./ggplot2_images/pretty_examples.png)\n\n```{r fig.width=7, fig.height=6,echo=FALSE}\n# img <- readPNG(\"./ggplot2_images/pretty_examples.png\")\n#  grid.raster(img)\n```\n\n\n\nInstall/load ggplot2\n===\n\n```{r}\nif(!require(ggplot2)){install.packages(\"ggplot2\")}\nrequire(ggplot2)\n```\n\nOutline (ggplot2)\n===\n\n1. Your first ggplot plot\n    + basic scatter plot \n    + Exercise 1\n2. Grammar of graphics\n    + More advanced plots\n    + Available plot elements and when to use them\n    + Exercise 2\n3. Saving a plot\n    \n***\n\n(PM?)  \n\n4. Expanding ggplot    \n5. Fine tuning your plot\n    + colours\n    + themes\n\n\n\nYour first ggplot \n===\n\nA basic scatter plot\n```{r fig.width=3, fig.height=3, eval=F}\nqplot(data=iris,\n      x=Sepal.Length,\n      y=Sepal.Width)\n```\n\n***\n\n```{r fig.width=3, fig.height=3, echo=F}\nqplot(data=iris,\n      x=Sepal.Length,\n      y=Sepal.Width)\n```\n\n\nCategorical x-axis  \n===\n```{r fig.width=4, fig.height=4}\nqplot(data=iris,\n      x=Species,\n      y=Sepal.Width)\n```\n\nLess basic scatter plot\n===\n```{r}\n?qplot\n```\n\nArguments\n```\nx\ny\n…\ndata\nxlab\nylab\nmain\n```\n\nLess basic scatter plot \n===\n\n```{r fig.width=4, fig.height=4}\nqplot(data=iris,\n      x=Sepal.Length,\n      xlab=\"Sepal Width (mm)\",\n      y=Sepal.Width,\n      ylab=\"Sepal Length (mm)\",\n      main=\"Sepal dimensions\")\n```\n\nExercise 1\n===\nproduce a basic plot with built in data\n```\nCO2\n?CO2\nBOD\ndata()\n```\nWARNING: THERE ARE MULTIPLE CO2/co2 datasets\n(CASE SENSITIVE)\n\n<div class=\"centered\">\n\n<script src=\"countdown.js\" type=\"text/javascript\"></script>\n<script type=\"application/javascript\">\nvar myCountdown2 = new Countdown({\n    \t\t\t\t\t\t\ttime: 300, \n\t\t\t\t\t\t\t\t\twidth:150, \n\t\t\t\t\t\t\t\t\theight:80, \n\t\t\t\t\t\t\t\t\trangeHi:\"minute\"\t// <- no comma on last item!\n\t\t\t\t\t\t\t\t\t});\n\n</script>\n\n</div>\n\nGrammar of graphics (gg)\n===\n\nA graphic is made of elements (layers)\n\n- data\n- aesthetics (aes)\n- transformation\n- geoms (geometric objects)\n- axis (coordinate system)\n- scales\n\n***\n\n![layers of a plot](./ggplot2_images/seperate_elements.png)\n\n\nAesthetics (aes) make data visible:\n===\n\n+ x,y : position along the x and y axis\n+ colour: the colour of the point\n+ group: what group a point belongs to \n+ shape: the figure used to plot a point\n+ linetype: the type of line used (solid, dashed, etc)\n+ size: the size of the point or line\n+ alpha: the transparency of the point \n\ngeometric objects(geoms)\n===\n\n+ point: scatterplot\n+ line: line plot, where lines connect points by increasing x value\n+ path: line plot, where lines connect points in sequence of appearance\n+ boxplot: box-and-whisker plots, for categorical y data\n+ bar: barplots\n+ histogram: histograms (for 1-dimensional data)\n\nSingle element edit\n===\n\nEditing an element produces a new graph\ne.g. just change the coordinate system\n\n\n```{r fig.width=3, fig.height=3,echo=FALSE}\nDF <- data.frame(variable = LETTERS[1:10], value = sample(10,\n                                                 replace = TRUE))\n\np_bar <- qplot(data=DF,\n              x=variable,\n              fill=variable,\n              y=value,\n              stat=\"identity\",\n              geom=\"bar\")\n\nprint(p_bar)\n\np_polar <- p_bar + coord_polar()\n\nprint(p_polar)\n```\n\n\nHow it works\n===\n\n1. create a simple plot object\n```{r eval=FALSE}\nplot.object<-qplot()\n```\n2. add graphical layers/complexity\n```{r eval=FALSE}\nplot.object<-plot.object+layer()\n```\n3. repeat step 2 until satisfied  \n4. print your object to screen (or to graphical device)  \n```{r  eval=FALSE}\nprint(plot.object)\n```\n\n\nScatter plot as an R object\n===\n\n```{r fig.width=3, fig.height=3,echo=T}\nbasic.plot<-qplot(data=iris,\n                  x=Sepal.Length,\n                  xlab=\"Sepal Width (mm)\",\n                  y=Sepal.Width,\n                  ylab=\"Sepal Length (mm)\",\n                  main=\"Sepal dimensions\")\n\nprint(basic.plot)\n```\n\nScatter plot with colour and shape\n===\n\n```{r fig.width=3, fig.height=3,echo=T}\nbasic.plot <- basic.plot+\n              aes(colour=Species,\n                  shape=Species)\n\n\t\t\tprint(basic.plot)\n```\n\n\nScatter plot with linear regression\n===\n\nAdd a geom (eg. linear smooth)\n\n```{r fig.width=3, fig.height=3,echo=T}\nlinear.smooth.plot <- basic.plot+\n\t\t\t  geom_smooth(method=\"lm\", se=F)\n                         print(linear.smooth.plot)\n```\n\n\nExercise 2\n===\n\nproduce a colorful plot containing linear regressions with built in data\n\n```\nCO2\n?CO2\nmsleep\n?msleep\nOrchardSprays\ndata()\n```\n<div class=\"centered\">\n\n<script src=\"countdown.js\" type=\"text/javascript\"></script>\n<script type=\"application/javascript\">\nvar myCountdown3 = new Countdown({\n    \t\t\t\t\t\t\ttime: 300, \n\t\t\t\t\t\t\t\t\twidth:150, \n\t\t\t\t\t\t\t\t\theight:80, \n\t\t\t\t\t\t\t\t\trangeHi:\"minute\"\t// <- no comma on last item!\n\t\t\t\t\t\t\t\t\t});\n\n</script>\n\n</div>\n\n\nUsing facets and groups: the basic plot\n===\n\n```{r fig.width=3, fig.height=3,echo=T}\nCO2.plot<-qplot(data=CO2,\n                x=conc,\n                y=uptake,\n                colour=Treatment)\n\nprint(CO2.plot)\n```\n\nFacets\n===\n\n```{r  eval=FALSE}\nplot.object<-plot.object + facet_grid(rows~columns)\n```\n                         \n                         \n```{r fig.width=3, fig.height=3,echo=T}\nCO2.plot<-CO2.plot+facet_grid(.~Type)\nprint(CO2.plot)\n```\n\nGroups\n===\n\nProblems when adding the geom_line\n\n```{r fig.width=3, fig.height=3,echo=T}\nprint(CO2.plot+geom_line())\n```\n\nGroups\n===\n\nSolution: specify groups\n\n```{r fig.width=3, fig.height=3,echo=T}\nCO2.plot<-CO2.plot+geom_line(aes(group=Plant))\nprint(CO2.plot)\n```\n\nAvailable elements\n===\n\nhttp://docs.ggplot2.org\n\n<iframe src=\"http://docs.ggplot2.org\" width=\"300\">\n  <p>Your browser does not support iframes.</p>\n</iframe>\n\nResources\n===\n\ncheatsheets: https://www.rstudio.com/resources/cheatsheets/\n\n<iframe src=\"https://www.rstudio.com/resources/cheatsheets/\" width=\"300\">\n  <p>Your browser does not support iframes.</p>\n</iframe>\n\n\nExercise 3\n===\n\nExplore geoms and other plot elements with the data you have used\n\n```\n\nmsleep\n?msleep\nOrchardSprays\ndata()\n```\n<div class=\"centered\">\n\n<script src=\"countdown.js\" type=\"text/javascript\"></script>\n<script type=\"application/javascript\">\nvar myCountdown3 = new Countdown({\n    \t\t\t\t\t\t\ttime: 300, \n\t\t\t\t\t\t\t\t\twidth:150, \n\t\t\t\t\t\t\t\t\theight:80, \n\t\t\t\t\t\t\t\t\trangeHi:\"minute\"\t// <- no comma on last item!\n\t\t\t\t\t\t\t\t\t});\n\n</script>\n\n</div>\n\n\nSaving plots\n===\n\n```{r  eval=FALSE}\npdf(\"./Plots/todays_plots.pdf\")\n  print(basic.plot)\n  print(plot.with.linear.smooth)\n  print(categorical.plot)\n  print(CO2.plot)\ngraphics.off()\n```\n\nall other base save functions available:  \n`bmp()`, `jpeg()`, etc\n\nSaving plots\n===\n\nggsave: saves last plot and guesses format from file name\n\n```{r  eval=FALSE}\nggsave(\"./Plots/todays_plots.jpeg\", basic.plot)\n```\n\n\n\nUsing the right tool for the right situation\n===\nbase R `plot` function has methods for many different object types\n\n```{r fig.width=3, fig.height=3,echo=T}\nplot(iris)\n```\n\n\nUsing the right tool for the right situation\n===\n\nbase R `plot` function has methods for many different object types\n\n```{r fig.width=3, fig.height=3,echo=T}\nlm.SR <- lm(sr ~ pop15 + pop75 + dpi + ddpi, data = LifeCycleSavings)\nplot(lm.SR)\n```\n\n\nExtending ggplot\n===\n\nggplot can be extended for plotting specific classes of objects\n\n`autoplot`\nand\n`fortify`\n\n\nExtending ggplot\n===\n\n`ggfortify` provides `autoplot`and  \n`fortify` for common models\n\n```{r fig.width=3, fig.height=3,echo=T, eval=F}\nrequire(ggfortify)\nautoplot(lm.SR)\n```\n\n***\n\n```{r fig.width=5, fig.height=5,echo=F}\nrequire(ggfortify)\nautoplot(lm.SR)\n```\n\n===\n\n```{r fig.width=3, fig.height=3,echo=T}\nhelp(package=ggfortify)\n```\n\nVegan users\n===\n\n```{r fig.width=3, fig.height=3,echo=T}\nif(!require(devtools)) {install.packages(\"devtools\")}\nrequire(devtools)\nif(!require(ggvegan)) {install_github(\"gavinsimpson/ggvegan\")}\nrequire(ggvegan)\ndata(dune)\ndata(dune.env)\n```\n\nVegan users\n===\n\n```{r fig.width=5, fig.height=5,echo=T,eval=T}\nsol <- cca(dune ~ A1 + Management,\n           data = dune.env)\nautoplot(sol)\n```\n\nVegan users\n===\n\n```{r fig.width=3, fig.height=3,echo=T}\nautoplot(sol) + theme_bw()\n```\n\n\n\nUsing the right tool for the right situation\n===\n\nbase R `plot` function has methods for many different object types\n\n```{r fig.width=3, fig.height=3,echo=T}\nnormal.plot <- plot(sol)\n```\n\n\nFine tunning: Scales\n===\nclass: small-code\n\n```{r fig.width=3, fig.height=3,echo=T}\nCO2.plot +\n  scale_y_continuous(name = \"CO2 uptake rate\",\n                     breaks = seq(5,50, by= 10),\n                     labels = seq(5,50, by= 10), \n                     trans=\"log10\")\n```\n\nFine tunning: Scales\n===\n\n```{r fig.width=3, fig.height=3,echo=T}\nCO2.plot+\n  scale_colour_brewer()\n```\n\nFine tunning: Scales\n===\n\n```{r fig.width=3, fig.height=3,echo=T}\nCO2.plot+\n  scale_colour_manual(values=c(\"nonchilled\"=\"red\",\n                               \"chilled\"=\"blue\"))\n```\n\n\nFine tunning: Scales\n===\nBonus!!! Wes Anderson colour palette\n\n![darjeelinglimited](./ggplot2_images/darjeelinglimited.jpg)\n\nFine tunning: Scales\n===\nBonus!!! Wes Anderson colour palette\n\n```{r fig.width=3, fig.height=3,echo=T}\nif(!require(devtools)) {install.packages(\"devtools\")}\nrequire(devtools)\nif(!require(wesanderson)){\ndevtools::install_github(\"karthik/wesanderson\")}\nrequire(wesanderson)\n```\n\nFine tunning: Scales\n===\nBonus!!! Wes Anderson colour palette\n\n```{r fig.width=3, fig.height=3,echo=T}\nrequire(wesanderson)\nbasic.plot + \n  scale_color_manual(values = wesanderson::wes_palette(\"Darjeeling\",3)) \n```\n\nFine tuning: Multiple plots\n===\n\n\n```{r fig.width=5, fig.height=5,echo=T}\nif(!require(gridExtra)) {install.packages(\"gridExtra\")}\nrequire(gridExtra)\n\ngrid.arrange(basic.plot, CO2.plot)\n```\n\nFine tuning: Multiple plots\n===\nclass: small-code\n\nSub-plots can be aligned and matched in size\n\n```{r fig.width=5, fig.height=5,echo=T}\nbasic.plot.table <- ggplot_gtable(ggplot_build(basic.plot))\nCO2.plot.table <- ggplot_gtable(ggplot_build(CO2.plot))\nmaxWidth = grid::unit.pmax(basic.plot.table$widths[2:3],\n                           CO2.plot.table$widths[2:3])\nbasic.plot.table$widths[2:3] <- as.list(maxWidth)\nCO2.plot.table$widths[2:3] <- as.list(maxWidth)\n```  \n\nFine tuning: Multiple plots\n===\nSub-plots can be aligned and matched in size\n\n```{r fig.width=5, fig.height=5,echo=T}\ngrid.arrange(basic.plot.table, \n             CO2.plot.table,\n             ncol=1)\n```\n\nFine tuning: Themes\n===\n\n`theme_set(theme())`  \nor  \n`plot+theme()`\n\n```{r fig.width=8, fig.height=3,echo=T}\nbw <- basic.plot+theme_bw()\ngrey <- basic.plot+theme_bw()\n\ngrid.arrange(basic.plot, bw, grey, nrow=1)\n```\n\n\nFine tuning: Themes\n===\nclass: small-code\n\n```{r fig.width=8, fig.height=3,echo=T}\nmytheme <- theme_grey() +\n theme(plot.title = element_text(colour = \"red\"))\nmytheme_plot <- basic.plot + mytheme\n\ngrid.arrange(basic.plot, mytheme_plot, nrow=1)\n```\n\n",
    "created" : 1445605944938.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "439820854",
    "id" : "B5A0B57",
    "lastKnownWriteTime" : 1445605947,
    "path" : "~/Documents/R/Data_wrangling_and_plotting/ggplot2.Rpres",
    "project_path" : "ggplot2.Rpres",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_presentation"
}